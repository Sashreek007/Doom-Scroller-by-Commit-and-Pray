import{g as Se,C as Te,M as we}from"./constants-BqRKAH88.js";import{m as P}from"./coins-CEGumQio.js";const Ee={facebook:{site:"facebook",scrollContainerSelectors:[]},x:{site:"x",scrollContainerSelectors:['[data-testid="primaryColumn"]','main[role="main"]','[aria-label="Timeline: Your Home Timeline"]']},tiktok:{site:"tiktok",scrollContainerSelectors:[]},instagram:{site:"instagram",scrollContainerSelectors:[]},snapchat:{site:"snapchat",scrollContainerSelectors:[]},reddit:{site:"reddit",scrollContainerSelectors:[]},youtube:{site:"youtube",scrollContainerSelectors:[]},pinterest:{site:"pinterest",scrollContainerSelectors:[]}};function Ce(){const c=window.location.hostname.toLowerCase(),i=Se(c);return i?{...Ee[i],hostname:c}:null}function U(c){const i=c,d=i.scrollHeight-i.clientHeight;if(!Number.isFinite(d)||d<=2)return 0;const u=window.getComputedStyle(i).overflowY.toLowerCase();return!(u==="auto"||u==="scroll"||u==="overlay")&&i.scrollTop<=0?0:d}function ve(c){let i=null,d=0;const g=U(c);g>d&&(i=c,d=g);const u=c.querySelectorAll("div, main, section, article");for(const f of u){const h=U(f);h>d&&(i=f,d=h)}return i}function Ie(c){let i=null,d=0;for(const g of c.scrollContainerSelectors){const u=document.querySelector(g);if(!u)continue;const f=ve(u);if(!f)continue;const h=U(f);h>d&&(i=f,d=h)}return i||window}function oe(c){return"scrollY"in c?c.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0:c.scrollTop}const Me=2e3,_e=2e3,Re=3,v=170,$=200,Be=1300,Ae=2600,Le=650,Ne=250,ke=5200,le=Ce();if(!le)console.warn("[DoomScroller] No config for",window.location.hostname);else{let c=function(e){const n=Math.max(0,e),t=Math.ceil(n/1e3),o=Math.floor(t/60),a=t%60;return`${o}:${a.toString().padStart(2,"0")}`},i=function(e){return e==="scroll_sprint"?"Scroll Sprint":e==="target_chase"?"Target Chase":"Battle"},d=function(){if(T&&B&&A&&L&&document.documentElement.contains(T))return T;const e=document.createElement("div");e.style.position="fixed",e.style.top="18px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.zIndex="2147483645",e.style.pointerEvents="none",e.style.minWidth="178px",e.style.maxWidth="calc(100vw - 24px)",e.style.padding="8px 14px 10px",e.style.borderRadius="14px",e.style.border="1px solid rgba(34,197,94,0.72)",e.style.background="linear-gradient(135deg, rgba(34,197,94,0.25), rgba(15,23,42,0.88))",e.style.backdropFilter="blur(8px)",e.style.boxShadow="0 0 24px rgba(34,197,94,0.36)",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="center",e.style.gap="2px",e.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const n=document.createElement("div");n.style.fontSize="10px",n.style.textTransform="uppercase",n.style.letterSpacing="0.08em",n.style.fontWeight="700",n.style.color="#86efac",n.textContent="Battle time left";const t=document.createElement("div");t.style.fontSize="30px",t.style.lineHeight="1",t.style.fontWeight="800",t.style.letterSpacing="0.04em",t.style.color="#39ff14",t.style.textShadow="0 0 12px rgba(57,255,20,0.7)",t.textContent="0:00";const o=document.createElement("div");return o.style.fontSize="10px",o.style.letterSpacing="0.05em",o.style.opacity="0.9",o.style.color="#d1fae5",o.style.textAlign="center",o.textContent="Room ------",e.appendChild(n),e.appendChild(t),e.appendChild(o),(document.body??document.documentElement).appendChild(e),T=e,B=n,A=t,L=o,e},g=function(){T&&(T.remove(),T=null),B=null,A=null,L=null},u=function(){m=null,g()},f=function(){if(!m){g();return}const e=Date.now();if(e>=m.roundEndMs){u(),V(!0);return}const n=e<m.roundStartMs,t=n?m.roundStartMs-e:m.roundEndMs-e,o=d(),a=B,l=A,s=L;!a||!l||!s||(n?(o.style.border="1px solid rgba(34,211,238,0.82)",o.style.background="linear-gradient(135deg, rgba(34,211,238,0.28), rgba(15,23,42,0.88))",o.style.boxShadow="0 0 24px rgba(34,211,238,0.36)",a.style.color="#67e8f9",l.style.color="#67e8f9",l.style.textShadow="0 0 12px rgba(34,211,238,0.66)",a.textContent="Battle starts in"):(o.style.border="1px solid rgba(34,197,94,0.72)",o.style.background="linear-gradient(135deg, rgba(34,197,94,0.25), rgba(15,23,42,0.88))",o.style.boxShadow="0 0 24px rgba(34,197,94,0.36)",a.style.color="#86efac",l.style.color="#39ff14",l.style.textShadow="0 0 12px rgba(57,255,20,0.7)",a.textContent="Battle time left"),l.textContent=c(t),s.textContent=`Room ${m.roomKey} ‚Ä¢ ${i(m.gameType)}`)},h=function(e){if(!(e!=null&&e.active)){if(K+=1,m&&Date.now()<m.roundEndMs+6e3&&K<5)return;u();return}K=0;const n=Date.parse(e.roundStartedAt??""),t=Date.parse(e.roundEndsAt??"");if(!Number.isFinite(n)||!Number.isFinite(t)||t<=n){u();return}m={roomKey:e.roomKey||"------",gameType:e.gameType??null,roundStartMs:n,roundEndMs:t},f()},re=function(){if(document.getElementById("doomscroller-battle-result-style"))return;const e=document.createElement("style");e.id="doomscroller-battle-result-style",e.textContent=`
      @keyframes doomBattlePageConfettiFall {
        0% { transform: translateY(-18vh) rotate(0deg); opacity: 1; }
        100% { transform: translateY(110vh) rotate(420deg); opacity: 0.15; }
      }
    `,(document.head??document.documentElement).appendChild(e)},H=function(){k!==null&&(window.clearTimeout(k),k=null),N&&(N.remove(),N=null)},se=function(e,n){H(),re();const t=e.winnerIds.includes(n),o=Math.floor(Number(e.payouts[n]??0)),a=`${o>=0?"+":""}${o} coins`,l=document.createElement("div");if(l.style.position="fixed",l.style.inset="0",l.style.zIndex="2147483647",l.style.pointerEvents="none",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="center",l.style.background="rgba(0, 0, 0, 0.48)",l.style.backdropFilter="blur(1px)",l.style.padding="18px",t){const C=document.createElement("div");C.style.position="absolute",C.style.inset="0",C.style.overflow="hidden";const ne=["#39ff14","#facc15","#00f0ff","#ff2d78","#ffffff"];for(let x=0;x<26;x+=1){const p=document.createElement("span");p.style.position="absolute",p.style.left=`${x*17%100}%`,p.style.top="-16%",p.style.width=`${6+x%4*2}px`,p.style.height=`${10+x%5*2}px`,p.style.borderRadius="2px",p.style.background=ne[x%ne.length],p.style.animation=`doomBattlePageConfettiFall ${1.8+x%6*.24}s linear ${x%7*.17}s infinite`,C.appendChild(p)}l.appendChild(C)}const s=document.createElement("div");s.style.position="relative",s.style.maxWidth="min(460px, calc(100vw - 40px))",s.style.width="100%",s.style.padding="22px 20px",s.style.borderRadius="22px",s.style.border=t?"1px solid rgba(57,255,20,0.72)":"1px solid rgba(255,45,120,0.72)",s.style.background=t?"linear-gradient(135deg, rgba(57,255,20,0.18), rgba(2,6,23,0.92))":"linear-gradient(135deg, rgba(255,45,120,0.18), rgba(2,6,23,0.92))",s.style.boxShadow=t?"0 0 46px rgba(57,255,20,0.25)":"0 0 46px rgba(255,45,120,0.24)",s.style.textAlign="center",s.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const r=document.createElement("div");r.textContent=t?"YOU WIN":"BETTER LUCK NEXT TIME",r.style.fontSize="clamp(34px, 8.5vw, 74px)",r.style.fontWeight="800",r.style.lineHeight="1",r.style.letterSpacing="0.06em",r.style.color=t?"#39ff14":"#ff2d78",r.style.textShadow=t?"0 0 18px rgba(57,255,20,0.7)":"0 0 16px rgba(255,45,120,0.65)";const y=document.createElement("div");y.textContent=a,y.style.marginTop="10px",y.style.fontSize="clamp(22px, 4.4vw, 38px)",y.style.fontWeight="700",y.style.color=t?"#86efac":"#fda4af";const w=document.createElement("div");w.textContent=`Room ${e.roomKey} ‚Ä¢ Pot ${e.pot} ‚Ä¢ Bet ${e.betCoins}`,w.style.marginTop="10px",w.style.fontSize="12px",w.style.opacity="0.85",w.style.color="#cbd5e1",s.appendChild(r),s.appendChild(y),s.appendChild(w),l.appendChild(s),(document.body??document.documentElement).appendChild(l),N=l,k=window.setTimeout(()=>{H()},ke)},ae=function(){if(S&&document.documentElement.contains(S))return S;const e=document.createElement("div");return e.style.position="fixed",e.style.top="18px",e.style.right="18px",e.style.zIndex="2147483646",e.style.pointerEvents="none",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="flex-end",e.style.gap="8px",(document.body??document.documentElement).appendChild(e),S=e,e},X=function(e,n){const t=Date.now(),o=Math.max(t,Q),a=Math.max(0,o-t),l=F?n+80:v+n+$+30;Q=o+l,window.setTimeout(()=>{const s=ae(),r=e();if(r.style.opacity="0",r.style.transform=F?"translateY(0) scale(1)":"translateY(10px) scale(0.94)",r.style.transition=F?"none":`opacity ${v}ms ease, transform ${v}ms ease`,s.appendChild(r),F){r.style.opacity="1",window.setTimeout(()=>{r.remove()},n);return}window.setTimeout(()=>{r.style.opacity="1",r.style.transform="translateY(0) scale(1)"},16),window.setTimeout(()=>{r.style.transition=`opacity ${$}ms ease, transform ${$}ms ease`,r.style.opacity="0",r.style.transform="translateY(-8px) scale(0.98)"},v+n),window.setTimeout(()=>{r.remove()},v+n+$+24)},a)},ie=function(){const e=document.createElement("div");return e.textContent="ü™ô +1 Coin",e.style.padding="11px 16px",e.style.borderRadius="999px",e.style.background="linear-gradient(135deg, rgba(255,230,80,0.56), rgba(245,158,11,0.52))",e.style.border="2px solid rgba(253,224,71,0.95)",e.style.color="#fffde9",e.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif",e.style.fontSize="16px",e.style.fontWeight="800",e.style.letterSpacing="0.03em",e.style.textShadow="0 0 10px rgba(255,245,157,0.85)",e.style.boxShadow="0 0 24px rgba(250,204,21,0.78), 0 0 42px rgba(245,158,11,0.44)",e.style.backdropFilter="blur(6px)",e},ce=function(e){return e==="legendary"?{border:"1px solid rgba(244,114,182,0.95)",background:"linear-gradient(135deg, rgba(244,114,182,0.28), rgba(217,70,239,0.32))",glow:"0 0 26px rgba(217,70,239,0.55), 0 0 42px rgba(244,114,182,0.38)",titleColor:"#fce7f3"}:e==="epic"?{border:"1px solid rgba(56,189,248,0.9)",background:"linear-gradient(135deg, rgba(34,211,238,0.25), rgba(59,130,246,0.32))",glow:"0 0 24px rgba(56,189,248,0.52), 0 0 38px rgba(59,130,246,0.32)",titleColor:"#e0f2fe"}:e==="rare"?{border:"1px solid rgba(74,222,128,0.95)",background:"linear-gradient(135deg, rgba(74,222,128,0.22), rgba(34,197,94,0.3))",glow:"0 0 22px rgba(74,222,128,0.45)",titleColor:"#dcfce7"}:{border:"1px solid rgba(148,163,184,0.8)",background:"linear-gradient(135deg, rgba(148,163,184,0.2), rgba(100,116,139,0.25))",glow:"0 0 14px rgba(148,163,184,0.3)",titleColor:"#f8fafc"}},de=function(e){const n=ce(e.rarity),t=document.createElement("div");t.style.width="min(320px, calc(100vw - 32px))",t.style.padding="12px 14px",t.style.borderRadius="14px",t.style.border=n.border,t.style.background=n.background,t.style.backdropFilter="blur(8px)",t.style.boxShadow=n.glow,t.style.color="#e5e7eb",t.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.marginBottom="6px";const a=document.createElement("span");a.textContent=e.icon||"üèÜ",a.style.fontSize="20px",a.style.lineHeight="1";const l=document.createElement("span");l.textContent=e.title||"New Achievement",l.style.fontSize="13px",l.style.fontWeight="800",l.style.letterSpacing="0.04em",l.style.color=n.titleColor,l.style.textTransform="uppercase";const s=document.createElement("span");s.textContent=e.rarity.toUpperCase(),s.style.marginLeft="auto",s.style.fontSize="10px",s.style.opacity="0.9",o.appendChild(a),o.appendChild(l),o.appendChild(s);const r=document.createElement("div");r.textContent=e.description,r.style.fontSize="12px",r.style.lineHeight="1.35",r.style.opacity="0.95",r.style.marginBottom="6px";const y=document.createElement("div");return y.textContent=e.roastLine,y.style.fontSize="11px",y.style.lineHeight="1.35",y.style.opacity="0.84",y.style.fontStyle="italic",t.appendChild(o),e.description&&t.appendChild(r),e.roastLine&&t.appendChild(y),t},ue=function(e){if(!(e<=0))for(let n=0;n<e;n+=1)X(ie,Be)},ye=function(e){X(()=>de(e),Ae)},me=function(e){if(!e||typeof e!="object")return!1;const n=e;if(n.type!=="ACHIEVEMENT_TOAST"||!n.payload||typeof n.payload!="object")return!1;const t=n.payload;return typeof t.eventKey=="string"&&typeof t.title=="string"&&typeof t.description=="string"&&typeof t.icon=="string"&&typeof t.rarity=="string"&&typeof t.roastLine=="string"},fe=function(e){if(!Number.isFinite(e)||e<=0||(_+=e,!Y))return;const n=P(M+_),t=n-R;t>0&&(ue(t),R=n)},G=function(){if(!b)return;const e=oe(b),n=Math.abs(e-O);n>1&&n<5e4&&(E+=n),O=e},J=function(){b&&b.removeEventListener("scroll",G)},j=function(){const e=Ie(I);b!==e&&(J(),b=e,O=oe(b),b.addEventListener("scroll",G,{passive:!0}))};const I=le;let E=0,b=null,O=0,M=0,_=0,R=0,Y=!1,q=0,z=null,S=null,Q=0,T=null,B=null,A=null,L=null,m=null,N=null,k=null,D=null,W=!1,Z=0,K=0;const F=window.matchMedia("(prefers-reduced-motion: reduce)").matches;async function V(e=!1){const n=Date.now();if(!(!e&&n-Z<250)&&!W){W=!0,Z=n;try{const t=await chrome.runtime.sendMessage({type:"GET_BATTLE_TIMER"});h(t),pe(t)}catch{}finally{W=!1}}}async function pe(e){const n=e==null?void 0:e.viewerUserId,t=e==null?void 0:e.latestRoundResult;if(!n||!t||!t.roomId||!t.settledAt)return;const o=`${t.roomId}:${t.settledAt}`;if(D===o)return;const a=`doom_battle_result_seen_${n}`;try{const l=await chrome.storage.local.get(a);if((typeof l[a]=="string"?l[a]:null)===o){D=o;return}}catch{}D=o,se(t,n);try{await chrome.storage.local.set({[a]:o})}catch{}}async function ee(){q+=1;try{const e=await chrome.runtime.sendMessage({type:"GET_STATS"}),n=Number((e==null?void 0:e.totalMeters)??0);if(Number.isFinite(n)){M=n,Y=!0,R=P(M+_);return}}catch{}if(q<Re){z=window.setTimeout(()=>{ee()},_e);return}M=0,Y=!0,R=P(_)}const te=e=>{me(e)&&ye(e.payload)};chrome.runtime.onMessage.addListener(te),j();const ge=setInterval(j,Me);ee(),V();const be=window.setInterval(()=>{V()},Le),xe=window.setInterval(()=>{f()},Ne),he=setInterval(()=>{if(E>0){const e=E*we,n={type:"SCROLL_UPDATE",payload:{site:I.site,pixels:E,meters:e,timestamp:Date.now()}};chrome.runtime.sendMessage(n).catch(()=>{}),fe(e),E=0}},Te);window.addEventListener("beforeunload",()=>{clearInterval(ge),clearInterval(he),clearInterval(be),clearInterval(xe),chrome.runtime.onMessage.removeListener(te),z!==null&&window.clearTimeout(z),S&&(S.remove(),S=null),u(),H(),J()}),console.log("[DoomScroller] Tracking scroll on",I.site,"(",I.hostname,")")}
