import{g as gt,C as xt,M as bt}from"./constants-BqRKAH88.js";import{m as z}from"./coins-CEGumQio.js";const ht={facebook:{site:"facebook",scrollContainerSelectors:[]},x:{site:"x",scrollContainerSelectors:['[data-testid="primaryColumn"]','main[role="main"]','[aria-label="Timeline: Your Home Timeline"]']},tiktok:{site:"tiktok",scrollContainerSelectors:[]},instagram:{site:"instagram",scrollContainerSelectors:[]},snapchat:{site:"snapchat",scrollContainerSelectors:[]},reddit:{site:"reddit",scrollContainerSelectors:[]},youtube:{site:"youtube",scrollContainerSelectors:[]},pinterest:{site:"pinterest",scrollContainerSelectors:[]}};function Tt(){const c=window.location.hostname.toLowerCase(),g=gt(c);return g?{...ht[g],hostname:c}:null}function St(c){for(const g of c.scrollContainerSelectors){const S=document.querySelector(g);if(S)return S}return window}function Q(c){return"scrollY"in c?c.scrollY:c.scrollTop}const Et=2e3,Ct=2e3,wt=3,T=170,N=200,vt=1300,It=2600,Mt=2e3,_t=250,Rt=5200,Z=Tt();if(!Z)console.warn("[DoomScroller] No config for",window.location.hostname);else{let c=function(t){const n=Math.max(0,t),e=Math.ceil(n/1e3),o=Math.floor(e/60),a=e%60;return`${o}:${a.toString().padStart(2,"0")}`},g=function(t){return t==="scroll_sprint"?"Scroll Sprint":t==="target_chase"?"Target Chase":"Battle"},S=function(){if(f&&M&&_&&R&&document.documentElement.contains(f))return f;const t=document.createElement("div");t.style.position="fixed",t.style.top="18px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.zIndex="2147483645",t.style.pointerEvents="none",t.style.minWidth="178px",t.style.maxWidth="calc(100vw - 24px)",t.style.padding="8px 14px 10px",t.style.borderRadius="14px",t.style.border="1px solid rgba(34,197,94,0.72)",t.style.background="linear-gradient(135deg, rgba(34,197,94,0.25), rgba(15,23,42,0.88))",t.style.backdropFilter="blur(8px)",t.style.boxShadow="0 0 24px rgba(34,197,94,0.36)",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="center",t.style.gap="2px",t.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const n=document.createElement("div");n.style.fontSize="10px",n.style.textTransform="uppercase",n.style.letterSpacing="0.08em",n.style.fontWeight="700",n.style.color="#86efac",n.textContent="Battle time left";const e=document.createElement("div");e.style.fontSize="30px",e.style.lineHeight="1",e.style.fontWeight="800",e.style.letterSpacing="0.04em",e.style.color="#39ff14",e.style.textShadow="0 0 12px rgba(57,255,20,0.7)",e.textContent="0:00";const o=document.createElement("div");return o.style.fontSize="10px",o.style.letterSpacing="0.05em",o.style.opacity="0.9",o.style.color="#d1fae5",o.style.textAlign="center",o.textContent="Room ------",t.appendChild(n),t.appendChild(e),t.appendChild(o),(document.body??document.documentElement).appendChild(t),f=t,M=n,_=e,R=o,t},Y=function(){f&&(f.remove(),f=null),M=null,_=null,R=null},E=function(){d=null,Y()},W=function(){if(!d){Y();return}const t=Date.now();if(t>=d.roundEndMs){E();return}const n=t<d.roundStartMs,e=n?d.roundStartMs-t:d.roundEndMs-t,o=S(),a=M,l=_,s=R;!a||!l||!s||(n?(o.style.border="1px solid rgba(34,211,238,0.82)",o.style.background="linear-gradient(135deg, rgba(34,211,238,0.28), rgba(15,23,42,0.88))",o.style.boxShadow="0 0 24px rgba(34,211,238,0.36)",a.style.color="#67e8f9",l.style.color="#67e8f9",l.style.textShadow="0 0 12px rgba(34,211,238,0.66)",a.textContent="Battle starts in"):(o.style.border="1px solid rgba(34,197,94,0.72)",o.style.background="linear-gradient(135deg, rgba(34,197,94,0.25), rgba(15,23,42,0.88))",o.style.boxShadow="0 0 24px rgba(34,197,94,0.36)",a.style.color="#86efac",l.style.color="#39ff14",l.style.textShadow="0 0 12px rgba(57,255,20,0.7)",a.textContent="Battle time left"),l.textContent=c(e),s.textContent=`Room ${d.roomKey} ‚Ä¢ ${g(d.gameType)}`)},tt=function(t){if(!(t!=null&&t.active)){E();return}const n=Date.parse(t.roundStartedAt??""),e=Date.parse(t.roundEndsAt??"");if(!Number.isFinite(n)||!Number.isFinite(e)||e<=n){E();return}d={roomKey:t.roomKey||"------",gameType:t.gameType??null,roundStartMs:n,roundEndMs:e},W()},et=function(){if(document.getElementById("doomscroller-battle-result-style"))return;const t=document.createElement("style");t.id="doomscroller-battle-result-style",t.textContent=`
      @keyframes doomBattlePageConfettiFall {
        0% { transform: translateY(-18vh) rotate(0deg); opacity: 1; }
        100% { transform: translateY(110vh) rotate(420deg); opacity: 0.15; }
      }
    `,(document.head??document.documentElement).appendChild(t)},k=function(){A!==null&&(window.clearTimeout(A),A=null),B&&(B.remove(),B=null)},nt=function(t,n){k(),et();const e=t.winnerIds.includes(n),o=Math.floor(Number(t.payouts[n]??0)),a=`${o>=0?"+":""}${o} coins`,l=document.createElement("div");if(l.style.position="fixed",l.style.inset="0",l.style.zIndex="2147483647",l.style.pointerEvents="none",l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="center",l.style.background="rgba(0, 0, 0, 0.48)",l.style.backdropFilter="blur(1px)",l.style.padding="18px",e){const h=document.createElement("div");h.style.position="absolute",h.style.inset="0",h.style.overflow="hidden";const q=["#39ff14","#facc15","#00f0ff","#ff2d78","#ffffff"];for(let m=0;m<26;m+=1){const y=document.createElement("span");y.style.position="absolute",y.style.left=`${m*17%100}%`,y.style.top="-16%",y.style.width=`${6+m%4*2}px`,y.style.height=`${10+m%5*2}px`,y.style.borderRadius="2px",y.style.background=q[m%q.length],y.style.animation=`doomBattlePageConfettiFall ${1.8+m%6*.24}s linear ${m%7*.17}s infinite`,h.appendChild(y)}l.appendChild(h)}const s=document.createElement("div");s.style.position="relative",s.style.maxWidth="min(460px, calc(100vw - 40px))",s.style.width="100%",s.style.padding="22px 20px",s.style.borderRadius="22px",s.style.border=e?"1px solid rgba(57,255,20,0.72)":"1px solid rgba(255,45,120,0.72)",s.style.background=e?"linear-gradient(135deg, rgba(57,255,20,0.18), rgba(2,6,23,0.92))":"linear-gradient(135deg, rgba(255,45,120,0.18), rgba(2,6,23,0.92))",s.style.boxShadow=e?"0 0 46px rgba(57,255,20,0.25)":"0 0 46px rgba(255,45,120,0.24)",s.style.textAlign="center",s.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const r=document.createElement("div");r.textContent=e?"YOU WIN":"BETTER LUCK NEXT TIME",r.style.fontSize="clamp(34px, 8.5vw, 74px)",r.style.fontWeight="800",r.style.lineHeight="1",r.style.letterSpacing="0.06em",r.style.color=e?"#39ff14":"#ff2d78",r.style.textShadow=e?"0 0 18px rgba(57,255,20,0.7)":"0 0 16px rgba(255,45,120,0.65)";const i=document.createElement("div");i.textContent=a,i.style.marginTop="10px",i.style.fontSize="clamp(22px, 4.4vw, 38px)",i.style.fontWeight="700",i.style.color=e?"#86efac":"#fda4af";const x=document.createElement("div");x.textContent=`Room ${t.roomKey} ‚Ä¢ Pot ${t.pot} ‚Ä¢ Bet ${t.betCoins}`,x.style.marginTop="10px",x.style.fontSize="12px",x.style.opacity="0.85",x.style.color="#cbd5e1",s.appendChild(r),s.appendChild(i),s.appendChild(x),l.appendChild(s),(document.body??document.documentElement).appendChild(l),B=l,A=window.setTimeout(()=>{k()},Rt)},ot=function(){if(p&&document.documentElement.contains(p))return p;const t=document.createElement("div");return t.style.position="fixed",t.style.top="18px",t.style.right="18px",t.style.zIndex="2147483646",t.style.pointerEvents="none",t.style.display="flex",t.style.flexDirection="column",t.style.alignItems="flex-end",t.style.gap="8px",(document.body??document.documentElement).appendChild(t),p=t,t},D=function(t,n){const e=Date.now(),o=Math.max(e,X),a=Math.max(0,o-e),l=L?n+80:T+n+N+30;X=o+l,window.setTimeout(()=>{const s=ot(),r=t();if(r.style.opacity="0",r.style.transform=L?"translateY(0) scale(1)":"translateY(10px) scale(0.94)",r.style.transition=L?"none":`opacity ${T}ms ease, transform ${T}ms ease`,s.appendChild(r),L){r.style.opacity="1",window.setTimeout(()=>{r.remove()},n);return}window.setTimeout(()=>{r.style.opacity="1",r.style.transform="translateY(0) scale(1)"},16),window.setTimeout(()=>{r.style.transition=`opacity ${N}ms ease, transform ${N}ms ease`,r.style.opacity="0",r.style.transform="translateY(-8px) scale(0.98)"},T+n),window.setTimeout(()=>{r.remove()},T+n+N+24)},a)},lt=function(){const t=document.createElement("div");return t.textContent="ü™ô +1 Coin",t.style.padding="11px 16px",t.style.borderRadius="999px",t.style.background="linear-gradient(135deg, rgba(255,230,80,0.56), rgba(245,158,11,0.52))",t.style.border="2px solid rgba(253,224,71,0.95)",t.style.color="#fffde9",t.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif",t.style.fontSize="16px",t.style.fontWeight="800",t.style.letterSpacing="0.03em",t.style.textShadow="0 0 10px rgba(255,245,157,0.85)",t.style.boxShadow="0 0 24px rgba(250,204,21,0.78), 0 0 42px rgba(245,158,11,0.44)",t.style.backdropFilter="blur(6px)",t},rt=function(t){return t==="legendary"?{border:"1px solid rgba(244,114,182,0.95)",background:"linear-gradient(135deg, rgba(244,114,182,0.28), rgba(217,70,239,0.32))",glow:"0 0 26px rgba(217,70,239,0.55), 0 0 42px rgba(244,114,182,0.38)",titleColor:"#fce7f3"}:t==="epic"?{border:"1px solid rgba(56,189,248,0.9)",background:"linear-gradient(135deg, rgba(34,211,238,0.25), rgba(59,130,246,0.32))",glow:"0 0 24px rgba(56,189,248,0.52), 0 0 38px rgba(59,130,246,0.32)",titleColor:"#e0f2fe"}:t==="rare"?{border:"1px solid rgba(74,222,128,0.95)",background:"linear-gradient(135deg, rgba(74,222,128,0.22), rgba(34,197,94,0.3))",glow:"0 0 22px rgba(74,222,128,0.45)",titleColor:"#dcfce7"}:{border:"1px solid rgba(148,163,184,0.8)",background:"linear-gradient(135deg, rgba(148,163,184,0.2), rgba(100,116,139,0.25))",glow:"0 0 14px rgba(148,163,184,0.3)",titleColor:"#f8fafc"}},st=function(t){const n=rt(t.rarity),e=document.createElement("div");e.style.width="min(320px, calc(100vw - 32px))",e.style.padding="12px 14px",e.style.borderRadius="14px",e.style.border=n.border,e.style.background=n.background,e.style.backdropFilter="blur(8px)",e.style.boxShadow=n.glow,e.style.color="#e5e7eb",e.style.fontFamily="JetBrains Mono, Inter, system-ui, sans-serif";const o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.gap="8px",o.style.marginBottom="6px";const a=document.createElement("span");a.textContent=t.icon||"üèÜ",a.style.fontSize="20px",a.style.lineHeight="1";const l=document.createElement("span");l.textContent=t.title||"New Achievement",l.style.fontSize="13px",l.style.fontWeight="800",l.style.letterSpacing="0.04em",l.style.color=n.titleColor,l.style.textTransform="uppercase";const s=document.createElement("span");s.textContent=t.rarity.toUpperCase(),s.style.marginLeft="auto",s.style.fontSize="10px",s.style.opacity="0.9",o.appendChild(a),o.appendChild(l),o.appendChild(s);const r=document.createElement("div");r.textContent=t.description,r.style.fontSize="12px",r.style.lineHeight="1.35",r.style.opacity="0.95",r.style.marginBottom="6px";const i=document.createElement("div");return i.textContent=t.roastLine,i.style.fontSize="11px",i.style.lineHeight="1.35",i.style.opacity="0.84",i.style.fontStyle="italic",e.appendChild(o),t.description&&e.appendChild(r),t.roastLine&&e.appendChild(i),e},at=function(t){if(!(t<=0))for(let n=0;n<t;n+=1)D(lt,vt)},it=function(t){D(()=>st(t),It)},ct=function(t){if(!t||typeof t!="object")return!1;const n=t;if(n.type!=="ACHIEVEMENT_TOAST"||!n.payload||typeof n.payload!="object")return!1;const e=n.payload;return typeof e.eventKey=="string"&&typeof e.title=="string"&&typeof e.description=="string"&&typeof e.icon=="string"&&typeof e.rarity=="string"&&typeof e.roastLine=="string"},dt=function(t){if(!Number.isFinite(t)||t<=0||(v+=t,!F))return;const n=z(w+v),e=n-I;e>0&&(at(e),I=n)},K=function(){if(!u)return;const t=Q(u),n=Math.abs(t-$);n>1&&n<5e4&&(b+=n),$=t},V=function(){u&&u.removeEventListener("scroll",K)},P=function(){const t=St(C);u!==t&&(V(),u=t,$=Q(u),u.addEventListener("scroll",K,{passive:!0}))};const C=Z;let b=0,u=null,$=0,w=0,v=0,I=0,F=!1,U=0,H=null,p=null,X=0,f=null,M=null,_=null,R=null,d=null,B=null,A=null,O=null;const L=window.matchMedia("(prefers-reduced-motion: reduce)").matches;async function G(){try{const t=await chrome.runtime.sendMessage({type:"GET_BATTLE_TIMER"});tt(t),yt(t)}catch{}}async function yt(t){const n=t==null?void 0:t.viewerUserId,e=t==null?void 0:t.latestRoundResult;if(!n||!e||!e.roomId||!e.settledAt)return;const o=`${e.roomId}:${e.settledAt}`;if(O===o)return;const a=`doom_battle_result_seen_${n}`;try{const l=await chrome.storage.local.get(a);if((typeof l[a]=="string"?l[a]:null)===o){O=o;return}}catch{}O=o,nt(e,n);try{await chrome.storage.local.set({[a]:o})}catch{}}async function J(){U+=1;try{const t=await chrome.runtime.sendMessage({type:"GET_STATS"}),n=Number((t==null?void 0:t.totalMeters)??0);if(Number.isFinite(n)){w=n,F=!0,I=z(w+v);return}}catch{}if(U<wt){H=window.setTimeout(()=>{J()},Ct);return}w=0,F=!0,I=z(v)}const j=t=>{ct(t)&&it(t.payload)};chrome.runtime.onMessage.addListener(j),P();const ut=setInterval(P,Et);J(),G();const mt=window.setInterval(()=>{G()},Mt),pt=window.setInterval(()=>{W()},_t),ft=setInterval(()=>{if(b>0){const t=b*bt,n={type:"SCROLL_UPDATE",payload:{site:C.site,pixels:b,meters:t,timestamp:Date.now()}};chrome.runtime.sendMessage(n).catch(()=>{}),dt(t),b=0}},xt);window.addEventListener("beforeunload",()=>{clearInterval(ut),clearInterval(ft),clearInterval(mt),clearInterval(pt),chrome.runtime.onMessage.removeListener(j),H!==null&&window.clearTimeout(H),p&&(p.remove(),p=null),E(),k(),V()}),console.log("[DoomScroller] Tracking scroll on",C.site,"(",C.hostname,")")}
